<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Conex_resource (conex.Conex_resource)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="generator" content="doc-ock-html v1.0.0-1-g1fc9bf0"/></head><body><nav id="top"><a href="../index.html">Up</a> &mdash; <span class="package">package <a href="../index.html">conex</a></span></nav><header><h1><span class="keyword">Module</span> <span class="module-path">Conex_resource</span></h1></header><p>Persistent data: on wire and record types</p><p>Every resource in conex is a piece of data (or metadata), and has its own
purpose. Resources stored on disk consists of a common header: a name, a
type, a counter, an epoch, and a creation timestamp. There are
broadly three kinds of resources: those containing identities (Team and
Author), those regulating access to packages (Authorisation), and
those with the digests of the opam repository data (Releases and
Release).</p><h2>Names and identifiers</h2><div class="spec type" id="type-name"><a href="#type-name" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>name</code><code><span class="keyword"> = </span>string</code><code></code></div><div class="doc"><p>The name of resources, used e.g. for package names.</p></div></div><div class="spec val" id="val-pp_name"><a href="#val-pp_name" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>pp_name : <a href="index.html#type-name">name</a> <a href="../Conex_utils/index.html#type-fmt">Conex_utils.fmt</a></code></div><div class="doc"><p><code class="code">pp_name name</code> is a pretty printer for <code class="code">name</code>.</p></div></div><div class="spec val" id="val-name_equal"><a href="#val-name_equal" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>name_equal : <a href="index.html#type-name">name</a> <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-name">name</a> <span class="keyword">&#8209;&gt;</span> bool</code></div><div class="doc"><p><code class="code">name_equal a b</code> is the result of a case insensitive comparison of <code class="code">a</code> and <code class="code">b</code>.</p></div></div><div class="spec type" id="type-identifier"><a href="#type-identifier" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>identifier</code><code><span class="keyword"> = </span>string</code><code></code></div><div class="doc"><p>The type of identifiers.</p></div></div><div class="spec val" id="val-pp_id"><a href="#val-pp_id" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>pp_id : <a href="index.html#type-identifier">identifier</a> <a href="../Conex_utils/index.html#type-fmt">Conex_utils.fmt</a></code></div><div class="doc"><p><code class="code">pp_id id</code> is a pretty printer for <code class="code">identifier</code>.</p></div></div><div class="spec val" id="val-id_equal"><a href="#val-id_equal" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>id_equal : <a href="index.html#type-identifier">identifier</a> <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-identifier">identifier</a> <span class="keyword">&#8209;&gt;</span> bool</code></div><div class="doc"><p><code class="code">id_equal a b</code> is the result of a case insensitive comparison of <code class="code">a</code> and <code class="code">b</code>.</p></div></div><div class="spec type" id="type-timestamp"><a href="#type-timestamp" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>timestamp</code><code><span class="keyword"> = </span>string</code><code></code></div><div class="doc"><p>The type for a timestamp, always a RFC3339 string in UTC (no timezone
information).</p></div></div><div class="spec val" id="val-pp_timestamp"><a href="#val-pp_timestamp" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>pp_timestamp : <a href="index.html#type-timestamp">timestamp</a> <a href="../Conex_utils/index.html#type-fmt">Conex_utils.fmt</a></code></div><div class="doc"></div></div><h2>Wire format</h2><div class="spec module" id="module-Wire"><a href="#module-Wire" class="anchor"></a><div class="def module"><code><span class="keyword">module </span><a href="Wire/index.html">Wire</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><div class="doc"><p>The wire encoding is abstract here, one suitable decoding and encoding
engine is <a href="../Conex_opam_encoding/index.html">Conex_opam_encoding</a>. The wire encoding is used for digest
computations, and persistent storage on disk.</p></div></div><h2>Resource types</h2><div class="spec type" id="type-typ"><a href="#type-typ" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>typ</code><span class="keyword"> = </span><code>[ </code><table class="variant"><tr id="type-typ.Root" class="anchored"><td class="def constructor"><a href="#type-typ.Root" class="anchor"></a><code><span class="keyword">| </span></code><code>`Root</code></td></tr><tr id="type-typ.Targets" class="anchored"><td class="def constructor"><a href="#type-typ.Targets" class="anchor"></a><code><span class="keyword">| </span></code><code>`Targets</code></td></tr></table><code> ]</code><code></code></div><div class="doc"><p>The sum type of all possible resources.</p></div></div><div class="spec val" id="val-typ_to_string"><a href="#val-typ_to_string" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>typ_to_string : <a href="index.html#type-typ">typ</a> <span class="keyword">&#8209;&gt;</span> string</code></div><div class="doc"><p><code class="code">resource_to_string res</code> is the string representation of <code class="code">res</code>.</p></div></div><div class="spec val" id="val-string_to_typ"><a href="#val-string_to_typ" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>string_to_typ : string <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-typ">typ</a> option</code></div><div class="doc"><p><code class="code">string_to_resource str</code> is either <code class="code">Some resource</code> or <code class="code">None</code>.</p></div></div><div class="spec val" id="val-pp_typ"><a href="#val-pp_typ" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>pp_typ : <a href="index.html#type-typ">typ</a> <a href="../Conex_utils/index.html#type-fmt">Conex_utils.fmt</a></code></div><div class="doc"><p><code class="code">pp_resource pp</code> is a pretty printer for <code class="code">resource</code>.</p></div></div><div class="spec val" id="val-typ_equal"><a href="#val-typ_equal" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>typ_equal : <a href="index.html#type-typ">typ</a> <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-typ">typ</a> <span class="keyword">&#8209;&gt;</span> bool</code></div><div class="doc"><p><code class="code">resource_equal a b</code> is <code class="code">true</code> if they are the same, otherwise <code class="code">false</code>.</p></div></div><div class="spec val" id="val-typ_of_wire"><a href="#val-typ_of_wire" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>typ_of_wire : <a href="Wire/index.html#type-s">Wire.s</a> <span class="keyword">&#8209;&gt;</span> (<a href="index.html#type-typ">typ</a>, string) Pervasives.result</code></div><div class="doc"></div></div><div class="spec type" id="type-err"><a href="#type-err" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>err</code><span class="keyword"> = </span><code>[ </code><table class="variant"><tr id="type-err.Parse" class="anchored"><td class="def constructor"><a href="#type-err.Parse" class="anchor"></a><code><span class="keyword">| </span></code><code>`Parse<span class="keyword"> of </span>string</code></td></tr><tr id="type-err.Unknown_alg" class="anchored"><td class="def constructor"><a href="#type-err.Unknown_alg" class="anchor"></a><code><span class="keyword">| </span></code><code>`Unknown_alg<span class="keyword"> of </span>string</code></td></tr><tr id="type-err.Malformed" class="anchored"><td class="def constructor"><a href="#type-err.Malformed" class="anchor"></a><code><span class="keyword">| </span></code><code>`Malformed</code></td></tr></table><code> ]</code><code></code></div><div class="doc"></div></div><div class="spec val" id="val-pp_err"><a href="#val-pp_err" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>pp_err : <a href="index.html#type-err">err</a> <a href="../Conex_utils/index.html#type-fmt">Conex_utils.fmt</a></code></div><div class="doc"></div></div><div class="spec module" id="module-Header"><a href="#module-Header" class="anchor"></a><div class="def module"><code><span class="keyword">module </span><a href="Header/index.html">Header</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><div class="doc"><p>Common header on disk</p></div></div><h2>Digests</h2><div class="spec module" id="module-Digest"><a href="#module-Digest" class="anchor"></a><div class="def module"><code><span class="keyword">module </span><a href="Digest/index.html">Digest</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><div class="doc"></div></div><div class="spec module" id="module-Digest_map"><a href="#module-Digest_map" class="anchor"></a><div class="def module"><code><span class="keyword">module </span><a href="Digest_map/index.html">Digest_map</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><div class="doc"></div></div><h2>Asymmetric key types</h2><div class="spec module" id="module-Key"><a href="#module-Key" class="anchor"></a><div class="def module"><code><span class="keyword">module </span><a href="Key/index.html">Key</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><div class="doc"></div></div><h2>Cryptographic signatures</h2><div class="spec module" id="module-Signature"><a href="#module-Signature" class="anchor"></a><div class="def module"><code><span class="keyword">module </span><a href="Signature/index.html">Signature</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><div class="doc"></div></div><div class="spec val" id="val-to_be_signed"><a href="#val-to_be_signed" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>to_be_signed : <a href="Wire/index.html#type-t">Wire.t</a> <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-timestamp">timestamp</a> <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-identifier">identifier</a> <span class="keyword">&#8209;&gt;</span> <a href="Signature/index.html#type-alg">Signature.alg</a> <span class="keyword">&#8209;&gt;</span> <a href="Wire/index.html#type-t">Wire.t</a></code></div><div class="doc"><p><code class="code">to_be_signed data timestamp id algorithm</code> prepares the representation used
by signing and verification</p></div></div><div class="spec module" id="module-Expression"><a href="#module-Expression" class="anchor"></a><div class="def module"><code><span class="keyword">module </span><a href="Expression/index.html">Expression</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><div class="doc"><h2>Delegation key expression</h2></div></div><h2>Root</h2><p>The root contains the (offline) root keys, also defines snapshot, timestamp,
and maintainers. Furthermore, it contains configuration information such as
where keys are located in this repository and where the data is stored.</p><div class="spec module" id="module-Root"><a href="#module-Root" class="anchor"></a><div class="def module"><code><span class="keyword">module </span><a href="Root/index.html">Root</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><div class="doc"></div></div><div class="spec module" id="module-Delegation"><a href="#module-Delegation" class="anchor"></a><div class="def module"><code><span class="keyword">module </span><a href="Delegation/index.html">Delegation</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><div class="doc"></div></div><div class="spec module" id="module-Target"><a href="#module-Target" class="anchor"></a><div class="def module"><code><span class="keyword">module </span><a href="Target/index.html">Target</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><div class="doc"></div></div><div class="spec module" id="module-Targets"><a href="#module-Targets" class="anchor"></a><div class="def module"><code><span class="keyword">module </span><a href="Targets/index.html">Targets</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><div class="doc"></div></div></body></html>